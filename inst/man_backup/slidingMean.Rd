\name{slidingMean}
\alias{slidingMean}

\title{Data smoothing for peptide microarrays}

\description{
  This function applies a sliding mean window to intensities to reduce noise generated by experimental variation, as well as take advantage of the overlapping nature of array peptides to share signal. 
}

\usage{
slidingMean(peptideSet, width = 5, verbose = FALSE, split.by.space = TRUE)
}

\arguments{
  \item{peptideSet}{A \code{peptideSet} object. The data.}
  \item{width}{A \code{numeric}. The width of the sliding window.}
  \item{verbose}{A \code{logical}. If set to TRUE, progress information will be displayed.}
  \item{split.by.space}{A \code{logical}. Should peptides be smoothed by position split by \code{space(ranges(peptideSet))}?}
}

\details{Peptide membership in the sliding mean window is determined by its position and the \code{width} argument. Two peptides are in the same window if the difference in their positions is less than or equal to \code{width/2}. A peptide's position is taken to be \code{position(peptideSet)}. 

A peptide's intensity is replaced by the mean of all peptide intensities within the peptide's sliding mean window.

When \code{split.by.space = TRUE}, peptides are smoothed within groups defined by the \link{space} of the RangedData object occupying the featureRange slot of \code{peptideSet}. This is useful if, for example, spaces indicate peptides drawn from separate proteins that should not be smoothed together. 
}

\value{
The function returns the peptideSet object with smoothed intensities.
}


\seealso{
\link{normalizeArray}, \link{summarizePeptides}
}

\keyword{functions}
